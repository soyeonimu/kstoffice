<!DOCTYPE html>
<html lang="ko">
<head>
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{ page.title }}</title>
  <meta name="description" content="{{ page.description | default: '김성태 법무사 사무소 - 수원·용인·화성 지역 개인회생·파산·고소장 상담 전문' }}">
  <meta name="author" content="김성태 법무사" />

  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
  <link rel="icon" href="/favicon.ico" type="image/x-icon" />

  <meta property="og:title" content="{{ page.title | default: '김성태 법무사 사무소' }}" />
  <meta property="og:description" content="{{ page.description | default: '수원·용인·화성 지역 법률상담 전문 법무사. 친절하고 신속한 법률서비스 제공.' }}" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="{{ page.url | absolute_url }}" />
  <meta property="og:image" content="/og-image.jpg" />
</head>

<body>

  {% include header.html %}

  <main>
    {{ content }}
  </main>

  {% include side-links.html %}
  {% include footer.html %}

  <!-- ✅ 헤더 스크롤 숨김/표시 -->
  <script>
    (function () {
      const header = document.getElementById('siteHeader');
      if (!header) return;

      let lastY = window.scrollY;
      let ticking = false;

      function onScroll() {
        const y = window.scrollY;

        if (y < 10) {
          header.classList.remove('header--hidden');
          lastY = y;
          return;
        }

        if (y > lastY + 8) header.classList.add('header--hidden');
        else if (y < lastY - 8) header.classList.remove('header--hidden');

        lastY = y;
      }

      window.addEventListener('scroll', () => {
        if (!ticking) {
          window.requestAnimationFrame(() => {
            onScroll();
            ticking = false;
          });
          ticking = true;
        }
      }, { passive: true });
    })();
  </script>

  <!-- ✅ 모바일 메뉴 + 서브메뉴 토글 -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const btn = document.getElementById("menuToggle");
      const gnb = document.getElementById("gnb");
      if (!btn || !gnb) return;

      // 전체 메뉴 열기/닫기
      btn.addEventListener("click", (e) => {
        e.stopPropagation();
        const isOpen = gnb.classList.toggle("is-open");
        btn.setAttribute("aria-expanded", String(isOpen));
      });

      // 모바일에서 서브메뉴 토글
      gnb.querySelectorAll("li.has-sub > a").forEach((link) => {
        link.addEventListener("click", (e) => {
          if (window.innerWidth > 1024) return; // PC는 링크 동작 유지

          e.preventDefault();
          e.stopPropagation();

          const li = link.parentElement;
          li.classList.toggle("sub-open");
        });
      });

      // 메뉴 바깥 클릭하면 닫기
      document.addEventListener("click", (e) => {
        if (!gnb.classList.contains("is-open")) return;
        if (btn.contains(e.target) || gnb.contains(e.target)) return;

        gnb.classList.remove("is-open");
        btn.setAttribute("aria-expanded", "false");
        gnb.querySelectorAll("li.has-sub.sub-open").forEach(li => li.classList.remove("sub-open"));
      });

      // 화면이 커지면 열린 서브 정리
      window.addEventListener("resize", () => {
        if (window.innerWidth > 1024) {
          gnb.querySelectorAll("li.has-sub.sub-open").forEach(li => li.classList.remove("sub-open"));
        }
      });
    });
  </script>

</body>
</html>
